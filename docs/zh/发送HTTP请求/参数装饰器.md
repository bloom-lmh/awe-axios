# 参数装饰器

[[toc]]

## @QueryParams

### 基本使用

`@QueryParams` 装饰器用于将参数对象转换为查询字符串。如下所示：

```ts {5-6,9}
@HttpApi({
  baseURL: 'http://localhost:3000/users/',
})
class UserApi {
  @Get('/pages')
  getUserPages(@QueryParam('page') page: number, @QueryParam('size') size: number): any {}
}
const userApi = new UserApi();
// 最终请求地址为http://localhost:3000/users/pages?page=1&size=20
const { data } = await userApi.getUserPages(1, 20);
console.log(data);
```

::: warning 装饰器重复与冲突
`@QueryParams` 装饰器和 `@QueryParams`、`@BodyParams`、`@PathParams` 装饰器不能同时使用。也就是说不能出现以下情况：

```ts
getUserPages(@QueryParam('page1')@QueryParam('page') page: number): any {}
// 或者
getUserPages(@PathParam('id') @QueryParam('size') size: number): any {}
```

实时上`axios-plus`中大部分的装饰器都不能重复出现，否则会报错。

:::

### 多参数合并

`@QueryParams` 装饰器可以将多个同名参数对象合并为一个数组，这样做对于传入数组参数十分有用。如下所示：

```ts {5-6,9}
@HttpApi({
  baseURL: 'http://localhost:3000/users/',
})
class UserApi {
  @Get('/groups')
  getUserGroups(@QueryParam('ids') id1: number, @QueryParam('ids') id2: number): any {}
}
// 最终请求地址为http://localhost:3000/users/groups?ids[]=2&ids[]=1
const { data } = await userApi.getUserGroups(1, 2);
console.log(data);
```

## @PathParam

`@PathParam` 装饰器用于将参数对象转换为路径参数。如下所示：

```ts {5-6,9}
@HttpApi({
  baseURL: 'http://localhost:3000/users/',
})
class UserApi {
  @Get('/:id')
  getUserById(@PathParam('id') id: number): any {}
}
// 最终请求地址为http://localhost:3000/users/1
const { data: data3 } = await userApi.getUserById(1);
console.log(data);
```

上面的例子中，`@PathParam` 装饰器将 `id` 参数对象转换为路径参数 `1`。

## @BodyParam

### 基本使用

`@BodyParam` 装饰器用于收集参数作为请求体参数。如下所示：

```ts {5-6,9}
@HttpApi({
  baseURL: 'http://localhost:3000/users/',
})
class UserApi {
  @Post('/')
  createUser(@BodyParam('user') user: { name: string; age: number }): any {}
}
// 最终请求地址为http://localhost:3000/users/1
const { data } = await userApi.createUser({ name: 'test', age: 18 });
console.log(data);
```

::: tip 单个参数名省略
当 `@BodyParam` 装饰器只接收一个参数时，`data`对象会被拍平一层，如下所示：

```json
data:{
  "name": "test",
  "age": 18
}
// 而不是
data: {
  "user": {
    "name": "test",
    "age": 18
  }
}
```

所以单参数的时候`axios-plus`允许你不写参数名：

```ts
@Post('/')
createUser(@BodyParam('user') user: { name: string; age: number }): any {}
```

:::

### 多参数合并

`@BodyParam` 装饰器可以将多个同名参数对象合并为一个对象，这样做对于传入对象参数十分有用。如下所示：

```ts {5-6,9}
@HttpApi({
  baseURL: 'http://localhost:3000/users/',
})
class UserApi {
  @Post('/groups')
  createUserGroups(
    @BodyParam('users') user1: { name: string; age: number },
    @BodyParam('users') user2: { name: string; age: number },
  ): any {}
}
// 最终请求地址为http://localhost:3000/users/groups
const { data } = await userApi.createUserGroups({ name: 'test1', age: 18 }, { name: 'test2', age: 20 });
console.log(data);
```

上面的例子中，`@BodyParam` 装饰器将 `user1` 和 `user2` 参数对象合并为一个对象，并作为请求体参数发送给服务器。
